edu ncsu csc itrust dao mysql java sql Connection java sql PreparedStatement java sql ResultSet java sql SQLException java util List edu ncsu csc itrust DBUtil edu ncsu csc itrust beans HealthRecord edu ncsu csc itrust beans loaders HealthRecordsBeanLoader edu ncsu csc itrust dao DAOFactory edu ncsu csc itrust exception DBException HealthRecordsDAO HealthRecordsBeanLoader DAOFactory HealthRecordsDAO DAOFactory factory factory factory List HealthRecord getAllHealthRecords mid DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong mid ResultSet rs ps executeQuery loader loadList rs SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps add HealthRecord record DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement loader loadParameters ps record numInserted SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps
edu ncsu csc itrust dao mysql java sql Connection java sql PreparedStatement java sql ResultSet java sql SQLException edu ncsu csc itrust DBUtil edu ncsu csc itrust RandomPassword edu ncsu csc itrust dao DAOFactory edu ncsu csc itrust enums Role edu ncsu csc itrust exception DBException edu ncsu csc itrust exception iTrustException org apache commons codec digest DigestUtils AuthDAO DAOFactory AuthDAO DAOFactory factory factory factory String addUser Long mid Role role String password DBException Connection PreparedStatement conn factory getConnection pstmt conn prepareStatement pstmt setLong mid password DigestUtils shaHex password pstmt setString password pstmt setString role toString pstmt setString String pstmt setString pwd pstmt executeUpdate pwd SQLException e e printStackTrace DBException e DBUtil closeConnection conn pstmt setSecurityQuestionAnswer String question String answer mid DBException Connection PreparedStatement conn factory getConnection pstmt conn prepareStatement pstmt setString question pstmt setString answer pstmt setLong mid pstmt executeUpdate SQLException e e printStackTrace DBException e DBUtil closeConnection conn pstmt String getUserName mid DBException iTrustException Role role HCP PHA ADMIN UAP ER LT factory getPersonnelDAO getName mid PATIENT factory getPatientDAO getName mid TESTER String valueOf mid iTrustException role Role getUserRole mid DBException iTrustException Connection PreparedStatement conn factory getConnection pstmt conn prepareStatement pstmt setLong mid ResultSet rs pstmt executeQuery rs next Role parse rs getString iTrustException SQLException e e printStackTrace DBException e DBUtil closeConnection conn pstmt getDeactivated mid DBException iTrustException Role role PATIENT Connection PreparedStatement conn factory getConnection pstmt conn prepareStatement pstmt setLong mid ResultSet rs pstmt executeQuery rs next rs getString iTrustException SQLException e e printStackTrace DBException e DBUtil closeConnection conn pstmt resetPassword mid String password DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement password DigestUtils shaHex password ps setString password ps setLong mid ps executeUpdate SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps String getSecurityQuestion mid iTrustException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong mid ResultSet r next r getString iTrustException mid SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps String getSecurityAnswer mid iTrustException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong mid ResultSet r next r getString iTrustException mid SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps recordLoginFailure String ipAddr DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString ipAddr numUpdated insertLoginFailureRow ipAddr conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps recordResetPasswordFailure String ipAddr DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString ipAddr numUpdated insertResetPasswordRow ipAddr conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps getResetPasswordFailures String ipAddr DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString ipAddr ResultSet rs next System currentTimeMillis rs getTimestamp getTime LOGIN_TIMEOUT updateResetFailuresToZero ipAddr conn rs getInt insertResetPasswordRow ipAddr conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps getLoginFailures String ipAddr DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString ipAddr ResultSet rs next System currentTimeMillis rs getTimestamp getTime LOGIN_TIMEOUT updateFailuresToZero ipAddr conn rs getInt insertLoginFailureRow ipAddr conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps insertLoginFailureRow String ipAddr failureCount Connection conn DBException SQLException PreparedStatement ps setString ipAddr ps setInt failureCount ps executeUpdate insertResetPasswordRow String ipAddr failureCount Connection conn DBException SQLException PreparedStatement ps setString ipAddr ps setInt failureCount ps executeUpdate updateFailuresToZero String ipAddr Connection conn DBException SQLException PreparedStatement ps setString ipAddr ps executeUpdate resetLoginFailuresToZero String ipAddr DBException SQLException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString ipAddr ps executeUpdate SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps updateResetFailuresToZero String ipAddr Connection conn DBException SQLException PreparedStatement ps setString ipAddr ps executeUpdate checkUserExists mid DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong mid ResultSet rs next SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps
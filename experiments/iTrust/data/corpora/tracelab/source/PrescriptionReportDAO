edu ncsu csc itrust dao mysql java sql Connection java sql PreparedStatement java sql ResultSet java sql SQLException java util List edu ncsu csc itrust DBUtil edu ncsu csc itrust beans PrescriptionReportBean edu ncsu csc itrust beans loaders PrescriptionReportBeanLoader edu ncsu csc itrust dao DAOFactory edu ncsu csc itrust exception DBException PrescriptionReportDAO DAOFactory PrescriptionReportBeanLoader PrescriptionReportDAO DAOFactory factory factory factory List PrescriptionReportBean byDate patientID String startDate String endDate DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong patientID ps setString startDate ps setString startDate ps setString endDate ps setString endDate ps setString startDate ps setString endDate ResultSet loader loadList rs SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps List PrescriptionReportBean byOfficeVisitAndPatient List Long ovIDs patientID DBException Connection PreparedStatement conn factory getConnection String ps conn prepareStatement preps ps setLong patientID prepareOVIDs ps ovIDs ResultSet loader loadList rs SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps prepareOVIDs PreparedStatement ps List Long ovIDs SQLException i ovIDs size i ps setLong i ovIDs get i String buildPreps size String i size i prep prep length prep substring prep length prep
edu ncsu csc itrust dao mysql java sql Connection java sql PreparedStatement java sql ResultSet java sql SQLException java sql Timestamp java util ArrayList java util Calendar java util Date java util List edu ncsu csc itrust DBUtil edu ncsu csc itrust beans DiagnosisBean edu ncsu csc itrust beans DiagnosisStatisticsBean edu ncsu csc itrust beans loaders DiagnosisBeanLoader edu ncsu csc itrust dao DAOFactory edu ncsu csc itrust exception DBException DiagnosesDAO DAOFactory DiagnosisBeanLoader DiagnosesDAO DAOFactory factory factory factory List DiagnosisBean getList visitID DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong visitID ResultSet loader loadList rs SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps DiagnosisStatisticsBean getDiagnosisCounts String icdCode String zipCode java util Date lower java util Date upper DBException Connection PreparedStatement DiagnosisStatisticsBean conn factory getConnection ps conn prepareStatement ps setString icdCode ps setString zipCode ps setTimestamp Timestamp lower getTime ps setTimestamp Timestamp upper getTime ResultSet rs last ps conn prepareStatement ps setString icdCode ps setString zipCode substring ps setTimestamp Timestamp lower getTime ps setTimestamp Timestamp upper getTime rs ps executeQuery rs last dsBean DiagnosisStatisticsBean zipCode local region lower upper SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps dsBean ArrayList DiagnosisStatisticsBean getWeeklyCounts String icdCode String zipCode java util Date lower java util Date upper DBException Calendar cal setTime lower cal set Calendar DAY_OF_WEEK Calendar MONDAY Date cal add Calendar HOUR Date ArrayList DiagnosisStatisticsBean DiagnosisStatisticsBean weekStats add db cal setTime upperDate cal add Calendar HOUR lowerDate cal getTime cal add Calendar HOUR upperDate cal getTime lowerDate before upper weekStats DiagnosisStatisticsBean getCountForWeekOf String icdCode String zipCode java util Date lower DBException Calendar cal setTime lower cal set Calendar DAY_OF_WEEK Calendar MONDAY Date cal add Calendar HOUR Date getDiagnosisCounts icdCode zipCode lowerDate upperDate Date findEarliestIncident String icdCode DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setString icdCode ResultSet rs next Date date SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps add DiagnosisBean bean DBException Connection PreparedStatement conn factory getConnection String ps conn prepareStatement statement ps setLong bean getVisitID ps setString bean getICDCode ps executeUpdate DBUtil getLastInsert conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps edit DiagnosisBean bean DBException Connection PreparedStatement conn factory getConnection String ps conn prepareStatement statement ps setLong bean getVisitID ps setString bean getICDCode ps setLong bean getOvDiagnosisID ps executeUpdate DBUtil getLastInsert conn SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps remove ovDiagnosisID DBException Connection PreparedStatement conn factory getConnection ps conn prepareStatement ps setLong ovDiagnosisID ps executeUpdate SQLException e e printStackTrace DBException e DBUtil closeConnection conn ps